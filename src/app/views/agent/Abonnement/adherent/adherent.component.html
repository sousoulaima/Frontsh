<div class="gestion-adherents-container">
  <div class="gestion-adherents">
    <!-- Modal for Adding/Editing an Adherent -->
    <div class="modal" *ngIf="showModal" @modalAnimation>
      <div class="modal-content">
        <h2 class="modal-title">{{ isEditing ? '√âditer l\'adh√©rent' : 'Ajouter un adh√©rent' }}</h2>
        <div *ngIf="formErrors.length > 0" class="error-messages">
          <p *ngFor="let error of formErrors" class="error">{{ error }}</p>
        </div>
        <div *ngIf="backendErrors.length > 0" class="error-messages">
          <p *ngFor="let error of backendErrors" class="error">{{ error }}</p>
        </div>
        <form (ngSubmit)="saveAdherent()" #adherentForm="ngForm">
          <div class="form-group" *ngIf="isEditing">
            <label>Code</label>
            <input
              type="text"
              [(ngModel)]="currentAdherent.code"
              name="code"
              readonly
              class="form-input"
            />
          </div>
          <div class="form-group">
            <label>Nom*</label>
            <input
              type="text"
              [(ngModel)]="currentAdherent.nom"
              name="nom"
              required
              class="form-input"
              placeholder="Entrez le nom"
            />
          </div>
          <div class="form-group">
            <label>Pr√©nom*</label>
            <input
              type="text"
              [(ngModel)]="currentAdherent.prenom"
              name="prenom"
              required
              class="form-input"
              placeholder="Entrez le pr√©nom"
            />
          </div>
          <div class="form-group">
            <label>Profession</label>
            <input
              type="text"
              [(ngModel)]="currentAdherent.profession"
              name="profession"
              class="form-input"
              placeholder="Entrez la profession"
            />
          </div>
          <div class="form-group">
            <label>Email*</label>
            <input
              type="email"
              [(ngModel)]="currentAdherent.email"
              name="email"
              required
              class="form-input"
              placeholder="Entrez l'email"
            />
          </div>
          <div class="form-group">
            <label>Adresse</label>
            <input
              type="text"
              [(ngModel)]="currentAdherent.adresse"
              name="adresse"
              class="form-input"
              placeholder="Entrez l'adresse"
            />
          </div>
          <div class="form-group">
            <label>T√©l√©phone 1</label>
            <input
              type="text"
              [(ngModel)]="currentAdherent.tel1"
              name="tel1"
              class="form-input"
              placeholder="Entrez le t√©l√©phone 1"
            />
          </div>
          <div class="form-group">
            <label>T√©l√©phone 2</label>
            <input
              type="text"
              [(ngModel)]="currentAdherent.tel2"
              name="tel2"
              class="form-input"
              placeholder="Entrez le t√©l√©phone 2"
            />
          </div>
          <div class="form-group">
            <label>CIN</label>
            <input
              type="text"
              [(ngModel)]="currentAdherent.cin"
              name="cin"
              class="form-input"
              placeholder="Entrez le CIN"
            />
          </div>
          <div class="form-group">
            <label>Date de naissance</label>
            <input
              type="date"
              [(ngModel)]="currentAdherent.datenaissance"
              name="datenaissance"
              class="form-input"
            />
          </div>
          <div class="form-group">
            <label>Code TVA</label>
            <input
              type="text"
              [(ngModel)]="currentAdherent.codetva"
              name="codetva"
              class="form-input"
              placeholder="Entrez le code TVA"
            />
          </div>
          <div class="form-group">
            <label>Raison sociale</label>
            <input
              type="text"
              [(ngModel)]="currentAdherent.raisonsoc"
              name="raisonsoc"
              class="form-input"
              placeholder="Entrez la raison sociale"
            />
          </div>
          <div class="form-group">
            <label>ID Pointage</label>
            <input
              type="text"
              [(ngModel)]="currentAdherent.idpointage"
              name="idpointage"
              class="form-input"
              placeholder="Entrez l'ID pointage"
            />
          </div>
          <div class="form-group">
            <label>Code Soci√©t√©</label>
            <input
              type="text"
              [(ngModel)]="currentAdherent.societe_code"
              name="societe_code"
              class="form-input"
              placeholder="Entrez le code soci√©t√©"
            />
          </div>
          <div class="modal-actions">
            <button type="button" class="cancel-btn" (click)="closeModal()">Annuler</button>
            <button type="submit" class="save-btn">Sauvegarder</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal for Viewing an Adherent -->
    <div class="modal" *ngIf="showViewModal" @modalAnimation>
      <div class="modal-content">
        <h2 class="modal-title">D√©tails de l'adh√©rent</h2>
        <div class="user-details">
          <p><strong>Code :</strong> {{ viewedAdherent?.code || 'N/A' }}</p>
          <p><strong>Nom :</strong> {{ viewedAdherent?.nom || 'N/A' }}</p>
          <p><strong>Pr√©nom :</strong> {{ viewedAdherent?.prenom || 'N/A' }}</p>
          <p><strong>Profession :</strong> {{ viewedAdherent?.profession || 'N/A' }}</p>
          <p><strong>Email :</strong> {{ viewedAdherent?.email || 'N/A' }}</p>
          <p><strong>Adresse :</strong> {{ viewedAdherent?.adresse || 'N/A' }}</p>
          <p><strong>T√©l√©phone 1 :</strong> {{ viewedAdherent?.tel1 || 'N/A' }}</p>
          <p><strong>T√©l√©phone 2 :</strong> {{ viewedAdherent?.tel2 || 'N/A' }}</p>
          <p><strong>CIN :</strong> {{ viewedAdherent?.cin || 'N/A' }}</p>
          <p><strong>Date de naissance :</strong> {{ viewedAdherent?.datenaissance || 'N/A' }}</p>
          <p><strong>Code TVA :</strong> {{ viewedAdherent?.codetva || 'N/A' }}</p>
          <p><strong>Raison sociale :</strong> {{ viewedAdherent?.raisonsoc || 'N/A' }}</p>
          <p><strong>ID Pointage :</strong> {{ viewedAdherent?.idpointage || 'N/A' }}</p>
          <p><strong>Code Soci√©t√© :</strong> {{ viewedAdherent?.societe_code || 'N/A' }}</p>
        </div>
        <div class="modal-actions">
          <button class="close-btn" (click)="closeViewModal()">Fermer</button>
        </div>
      </div>
    </div>

    <!-- Modal for Delete Confirmation -->
    <div class="modal" *ngIf="showDeleteConfirm" @modalAnimation>
      <div class="modal-content">
        <h2 class="modal-title">Confirmer la suppression</h2>
        <p class="modal-text">√ätes-vous s√ªr de vouloir supprimer l'adh√©rent {{ adherentToDelete?.code }} ?</p>
        <div class="modal-actions">
          <button class="cancel-btn" (click)="cancelDelete()">Annuler</button>
          <button class="delete-btn" (click)="deleteAdherent()">Supprimer</button>
        </div>
      </div>
    </div>

    <!-- Header Section -->
    <div class="header">
      <div class="header-title">
        <h1>Gestion des Adh√©rents</h1>
        <p>Liste des adh√©rents enregistr√©s ({{ filteredAdherents.length }} adh√©rents)</p>
      </div>
      <button class="add-btn" (click)="openAddAdherentModal()">+ Ajouter un adh√©rent</button>
    </div>

    <!-- Search and Filter Section -->
    <div class="search-filter">
      <div class="search">
        <input
          type="text"
          placeholder="Rechercher un adh√©rent..."
          [(ngModel)]="searchQuery"
          (input)="filterAdherents()"
          class="search-input"
        />
        <span class="search-icon">üîç</span>
      </div>
      <div class="filter-container">
        <button class="filter-btn" (click)="toggleFilter()">Filtrer ‚ñº</button>
        <div class="filter-dropdown" *ngIf="showFilter">
          <label class="filter-label">
            Profession :
            <input
              type="text"
              [(ngModel)]="filterProfession"
              (input)="filterAdherents()"
              class="filter-input"
              placeholder="Filtrer par profession"
            />
          </label>
        </div>
      </div>
    </div>

    <!-- Adherents Table -->
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>CODE</th>
            <th>NOM</th>
            <th>PR√âNOM</th>
            <th>PROFESSION</th>
            <th>EMAIL</th>
            <th>ADRESSE</th>
            <th>T√âL√âPHONE 1</th>
            <th>T√âL√âPHONE 2</th>
            <th>DATE NAISSANCE</th>
            <th>CIN</th>
            <th>CODE TVA</th>
            <th>ID POINTAGE</th>
            <th>RAISON SOCIALE</th>
            <th>CODE SOCI√âT√â</th>
            <th>ACTIONS</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let adherent of filteredAdherents">
            <td>{{ adherent.code || 'N/A' }}</td>
            <td>{{ adherent.nom || 'N/A' }}</td>
            <td>{{ adherent.prenom || 'N/A' }}</td>
            <td>{{ adherent.profession || 'N/A' }}</td>
            <td>{{ adherent.email || 'N/A' }}</td>
            <td>{{ adherent.adresse || 'N/A' }}</td>
            <td>{{ adherent.tel1 || 'N/A' }}</td>
            <td>{{ adherent.tel2 || 'N/A' }}</td>
            <td>{{ adherent.datenaissance || 'N/A' }}</td>
            <td>{{ adherent.cin || 'N/A' }}</td>
            <td>{{ adherent.codetva || 'N/A' }}</td>
            <td>{{ adherent.idpointage || 'N/A' }}</td>
            <td>{{ adherent.raisonsoc || 'N/A' }}</td>
            <td>{{ adherent.societe_code || 'N/A' }}</td>
            <td class="actions">
              <button class="action-btn view" (click)="viewAdherent(adherent)" title="Voir">üëÅÔ∏è</button>
              <button class="action-btn edit" (click)="openEditAdherentModal(adherent)" title="√âditer">‚úèÔ∏è</button>
              <button class="action-btn delete" (click)="confirmDeleteAdherent(adherent)" title="Supprimer">üóëÔ∏è</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>