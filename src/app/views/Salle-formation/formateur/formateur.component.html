<div class="gestion-formateurs-container">
  <div class="gestion-formateurs">
    <!-- Modal for Adding/Editing a Formateur -->
    <div class="modal" *ngIf="showModal" @modalAnimation>
      <div class="modal-content">
        <h2 class="modal-title">{{ isEditing ? '√âditer le formateur' : 'Ajouter un formateur' }}</h2>
        <form (ngSubmit)="saveFormateur()" #formateurForm="ngForm">
          <!-- Section: Informations personnelles -->
          <div class="form-section">
            <h3>Informations personnelles</h3>
            <div class="form-grid">
              <div class="form-group">
                <label>Code <span class="required">*</span></label>
                <input
                  type="text"
                  [(ngModel)]="currentFormateur.codefor"
                  name="codefor"
                  #codefor="ngModel"
                  required
                  readonly
                  class="form-input"
                  [ngClass]="{'invalid': codefor.invalid && (codefor.dirty || codefor.touched)}"
                />
                <span class="error" *ngIf="codefor.invalid && (codefor.dirty || codefor.touched)">Le code est requis.</span>
              </div>
              <div class="form-group">
                <label>Nom <span class="required">*</span></label>
                <input
                  type="text"
                  [(ngModel)]="currentFormateur.nomfor"
                  name="nomfor"
                  #nomfor="ngModel"
                  required
                  pattern="[A-Za-z√Ä-√ø\s-]+"
                  class="form-input"
                  [ngClass]="{'invalid': nomfor.invalid && (nomfor.dirty || nomfor.touched)}"
                />
                <span class="error" *ngIf="nomfor.invalid && (nomfor.dirty || nomfor.touched)">
                  {{ nomfor.errors?.['required'] ? 'Le nom est requis.' : 'Le nom ne doit contenir que des lettres, espaces ou tirets.' }}
                </span>
              </div>
              <div class="form-group">
                <label>Pr√©nom <span class="required">*</span></label>
                <input
                  type="text"
                  [(ngModel)]="currentFormateur.prenomfor"
                  name="prenomfor"
                  #prenomfor="ngModel"
                  required
                  pattern="[A-Za-z√Ä-√ø\s-]+"
                  class="form-input"
                  [ngClass]="{'invalid': prenomfor.invalid && (prenomfor.dirty || prenomfor.touched)}"
                />
                <span class="error" *ngIf="prenomfor.invalid && (prenomfor.dirty || prenomfor.touched)">
                  {{ prenomfor.errors?.['required'] ? 'Le pr√©nom est requis.' : 'Le pr√©nom ne doit contenir que des lettres, espaces ou tirets.' }}
                </span>
              </div>
            </div>
          </div>

          <!-- Section: Informations de contact -->
          <div class="form-section">
            <h3>Informations de contact</h3>
            <div class="form-grid">
              <div class="form-group">
                <label>Email <span class="required">*</span></label>
                <input
                  type="email"
                  [(ngModel)]="currentFormateur.emailfor"
                  name="emailfor"
                  #emailfor="ngModel"
                  required
                  email
                  class="form-input"
                  [ngClass]="{'invalid': emailfor.invalid && (emailfor.dirty || emailfor.touched)}"
                />
                <span class="error" *ngIf="emailfor.invalid && (emailfor.dirty || emailfor.touched)">Email invalide.</span>
              </div>
              <div class="form-group">
                <label>T√©l√©phone <span class="required">*</span></label>
                <input
                  type="tel"
                  [(ngModel)]="currentFormateur.telfor"
                  name="telfor"
                  #telfor="ngModel"
                  required
                  pattern="[0-9]{8}"
                  class="form-input"
                  [ngClass]="{'invalid': telfor.invalid && (telfor.dirty || telfor.touched)}"
                />
                <span class="error" *ngIf="telfor.invalid && (telfor.dirty || telfor.touched)">
                  8 chiffres requis.
                </span>
              </div>
              <div class="form-group full-width">
                <label>Adresse <span class="required">*</span></label>
                <input
                  type="text"
                  [(ngModel)]="currentFormateur.adrfor"
                  name="adrfor"
                  #adrfor="ngModel"
                  required
                  class="form-input"
                  [ngClass]="{'invalid': adrfor.invalid && (adrfor.dirty || adrfor.touched)}"
                />
                <span class="error" *ngIf="adrfor.invalid && (adrfor.dirty || adrfor.touched)">L'adresse est requise.</span>
              </div>
            </div>
          </div>

          <div class="modal-actions">
            <button type="button" class="cancel-btn" (click)="closeModal()">Annuler</button>
            <button type="submit" class="save-btn" [disabled]="!formateurForm.valid">Sauvegarder</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal for Viewing a Formateur -->
    <div class="modal" *ngIf="showViewModal" @modalAnimation>
      <div class="modal-content">
        <h2 class="modal-title">D√©tails du formateur</h2>
        <div class="user-details">
          <p><strong>Code :</strong> {{ viewedFormateur?.codefor }}</p>
          <p><strong>Nom :</strong> {{ viewedFormateur?.nomfor }}</p>
          <p><strong>Pr√©nom :</strong> {{ viewedFormateur?.prenomfor }}</p>
          <p><strong>Email :</strong> {{ viewedFormateur?.emailfor }}</p>
          <p><strong>T√©l√©phone :</strong> {{ viewedFormateur?.telfor }}</p>
          <p><strong>Adresse :</strong> {{ viewedFormateur?.adrfor }}</p>
        </div>
        <div class="modal-actions">
          <button class="close-btn" (click)="closeViewModal()">Fermer</button>
        </div>
      </div>
    </div>

    <!-- Modal for Delete Confirmation -->
    <div class="modal" *ngIf="showDeleteConfirm" @modalAnimation>
      <div class="modal-content">
        <h2 class="modal-title">Confirmer la suppression</h2>
        <p class="modal-text">√ätes-vous s√ªr de vouloir supprimer le formateur {{ formateurToDelete?.codefor }} ?</p>
        <div class="modal-actions">
          <button class="cancel-btn" (click)="cancelDelete()">Annuler</button>
          <button class="delete-btn" (click)="deleteFormateur()">Supprimer</button>
        </div>
      </div>
    </div>

    <!-- Header Section -->
    <div class="header">
      <div class="header-title">
        <h1 class="text-blue-800 animate-fade-in">Gestion des Formateurs</h1>
        <p class="text-gray-600 animate-fade-in">Liste des formateurs enregistr√©s ({{ filteredFormateurs.length }} formateurs)</p>
      </div>
      <div class="actions">
        <button class="add-btn" (click)="openAddFormateurModal()">+ Ajouter un formateur</button>
      </div>
    </div>

    <!-- Search Section -->
    <div class="search-filter">
      <div class="search">
        <input
          type="text"
          placeholder="Rechercher un formateur..."
          [(ngModel)]="searchQuery"
          (input)="filterFormateurs()"
          class="search-input"
        />
        <span class="search-icon">üîç</span>
      </div>
    </div>

    <!-- Formateurs Table -->
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>CODE</th>
            <th>NOM</th>
            <th>PR√âNOM</th>
            <th>EMAIL</th>
            <th>T√âL√âPHONE</th>
            <th>ADRESSE</th>
            <th>ACTIONS</th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="let formateur of filteredFormateurs; let i = index"
            class="animate-slide-in-right"
            [ngClass]="'animation-delay-' + (i * 100)"
          >
            <td>{{ formateur.codefor }}</td>
            <td>{{ formateur.nomfor }}</td>
            <td>{{ formateur.prenomfor }}</td>
            <td>{{ formateur.emailfor }}</td>
            <td>{{ formateur.telfor }}</td>
            <td>{{ formateur.adrfor }}</td>
            <td class="actions">
              <button class="action-btn view" (click)="viewFormateur(formateur)" title="Voir">üëÅÔ∏è</button>
              <button class="action-btn edit" (click)="openEditFormateurModal(formateur)" title="√âditer">‚úèÔ∏è</button>
              <button class="action-btn delete" (click)="confirmDeleteFormateur(formateur)" title="Supprimer">üóëÔ∏è</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>