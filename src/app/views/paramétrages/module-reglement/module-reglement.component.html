<div class="gestion-modalites-container">
  <div class="gestion-modalites">
    <!-- Success Message -->
    <div class="success-message" *ngIf="successMessage" @successAnimation>
      {{ successMessage }}
    </div>

    <!-- Modal for Adding/Editing a Modalit√© -->
    <div class="modal" *ngIf="showModal" @modalAnimation>
      <div class="modal-content">
        <h2 class="modal-title">{{ isEditing ? 'Modifier la modalit√©' : 'Ajouter une modalit√©' }}</h2>
        <form (ngSubmit)="saveModalite()" #modaliteForm="ngForm">
          <!-- Code Modalit√© (affich√© seulement si on √©dite) -->
          <div class="form-group" *ngIf="isEditing">
            <label>Code Modalit√©</label>
            <input
              type="text"
              [(ngModel)]="currentModalite.codeMod"
              name="codeMod"
              readonly
              class="form-input"
            />
          </div>

          <!-- D√©signation Modalit√© -->
          <div class="form-group">
            <label>D√©signation Modalit√©</label>
            <input
              type="text"
              [(ngModel)]="currentModalite.designationmod"
              name="designationmod"
              required
              #designationmod="ngModel"
              class="form-input"
              placeholder="Entrez la d√©signation"
              [ngClass]="{'invalid': designationmod.invalid && designationmod.touched}"
            />
            <span class="error" *ngIf="designationmod.invalid && designationmod.touched">La d√©signation est requise</span>
          </div>

          <div class="modal-actions">
            <button type="button" class="cancel-btn" (click)="closeModal()" aria-label="Annuler">Annuler</button>
            <button
              type="submit"
              class="save-btn"
              [disabled]="!modaliteForm.valid"
              aria-label="Enregistrer"
            >Enregistrer</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal for Viewing a Modalit√© -->
    <div class="modal" *ngIf="showViewModal" @modalAnimation>
      <div class="modal-content">
        <h2 class="modal-title">D√©tails de la modalit√©</h2>
        <div class="user-details">
          <p><strong>Code Modalit√© :</strong> {{ viewedModalite?.codeMod || 'N/A' }}</p>
          <p><strong>D√©signation Modalit√© :</strong> {{ viewedModalite?.designationmod || 'N/A' }}</p>
        </div>
        <div class="modal-actions">
          <button class="close-btn" (click)="closeViewModal()" aria-label="Fermer">Fermer</button>
        </div>
      </div>
    </div>

    <!-- Modal for Delete Confirmation -->
    <div class="modal" *ngIf="showDeleteConfirm" @modalAnimation>
      <div class="modal-content">
        <h2 class="modal-title">Confirmer la suppression</h2>
        <p class="modal-text">
          √ätes-vous s√ªr de vouloir supprimer la modalit√© {{ modaliteToDelete?.designationmod || 'N/A' }} ?
        </p>
        <div class="modal-actions">
          <button class="cancel-btn" (click)="cancelDelete()" aria-label="Annuler">Annuler</button>
          <button class="delete-btn" (click)="deleteModalite()" aria-label="Supprimer">Supprimer</button>
        </div>
      </div>
    </div>

    <!-- Header Section -->
    <div class="header">
      <div class="header-title">
        <h1>Modalit√©s de R√®glement</h1>
        <p>Liste des modalit√©s de r√®glement ({{ filteredModalites.length }} modalit√©s)</p>
      </div>
      <div class="actions">
        <button class="add-btn" (click)="openAddModal()" aria-label="Ajouter une modalit√©">+ Ajouter une modalit√©</button>
      </div>
    </div>

    <!-- Search Section -->
    <div class="search-filter">
      <div class="search">
        <input
          type="text"
          class="search-input"
          placeholder="Rechercher une modalit√©..."
          [(ngModel)]="searchQuery"
          (input)="filterModalites()"
          aria-label="Rechercher une modalit√©"
        />
        <span class="search-icon">üîç</span>
      </div>
    </div>

    <!-- Modalit√©s Table -->
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>CODE MODALIT√â</th>
            <th>D√âSIGNATION MODALIT√â</th>
            <th>ACTIONS</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let modalite of filteredModalites">
            <td>{{ modalite.codeMod || 'N/A' }}</td>
            <td>{{ modalite.designationmod || 'N/A' }}</td>
            <td class="actions">
              <button class="action-btn view" (click)="viewModalite(modalite)" title="Voir" aria-label="Voir les d√©tails">üëÅÔ∏è</button>
              <button class="action-btn edit" (click)="openEditModal(modalite)" title="√âditer" aria-label="√âditer la modalit√©">‚úèÔ∏è</button>
              <button class="action-btn delete" (click)="confirmDeleteModalite(modalite)" title="Supprimer" aria-label="Supprimer la modalit√©">üóëÔ∏è</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>